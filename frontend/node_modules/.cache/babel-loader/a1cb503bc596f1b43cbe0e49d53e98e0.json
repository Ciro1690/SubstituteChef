{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _createForOfIteratorHelper from\"/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _asyncToGenerator from\"/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import ChefApi from'../api/api';import{Button}from'@material-ui/core';import{formatDate}from'../utilities/utility';import Application from'./Application';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CompaniesApplications=function CompaniesApplications(_ref){var currentUser=_ref.currentUser;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),companies=_useState2[0],setCompanies=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),decided=_useState4[0],setDecided=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),errors=_useState8[0],setErrors=_useState8[1];useEffect(function(){function getApplications(){return _getApplications.apply(this,arguments);}function _getApplications(){_getApplications=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var applicationsArr,userCompanies,_iterator,_step,company,companyApplications;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:applicationsArr=[];_context.next=3;return ChefApi.getCompaniesFromUsername(currentUser);case 3:userCompanies=_context.sent;_iterator=_createForOfIteratorHelper(userCompanies.companies);_context.prev=5;_iterator.s();case 7:if((_step=_iterator.n()).done){_context.next=15;break;}company=_step.value;_context.next=11;return ChefApi.getJobsForCompany(company.id);case 11:companyApplications=_context.sent;applicationsArr.push([company,companyApplications]);case 13:_context.next=7;break;case 15:_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](5);_iterator.e(_context.t0);case 20:_context.prev=20;_iterator.f();return _context.finish(20);case 23:setCompanies(applicationsArr);setIsLoading(false);setDecided(false);case 26:case\"end\":return _context.stop();}}},_callee,null,[[5,17,20,23]]);}));return _getApplications.apply(this,arguments);}if(isLoading&&currentUser!==null){getApplications();}},[decided,currentUser,isLoading]);var acceptApplicant=function acceptApplicant(_ref2){var _ref3=_slicedToArray(_ref2,2),username=_ref3[0],jobId=_ref3[1];return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var status;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return ChefApi.updateApplication(username,jobId,{status:\"APPROVED\"});case 2:status=_context2.sent;setDecided(true);alert(\"You have \".concat(status,\" this job\"));case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref4.apply(this,arguments);};}();};var denyApplicant=function denyApplicant(_ref5){var _ref6=_slicedToArray(_ref5,2),username=_ref6[0],jobId=_ref6[1];return/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var status;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return ChefApi.updateApplication(username,jobId,{status:\"DENIED\"});case 2:status=_context3.sent;setDecided(true);alert(\"You have \".concat(status,\" this job\"));case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref7.apply(this,arguments);};}();};var deleteJob=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return ChefApi.deleteJob(id);case 3:alert(\"Deleted job\");_context4.next=10;break;case 6:_context4.prev=6;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0);setErrors(\"Unable to delete job\");case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[0,6]]);}));return function deleteJob(_x3){return _ref8.apply(this,arguments);};}();return!isLoading&&companies.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-3\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Open Applications\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"row applications-ul\",children:companies.map(function(company){return/*#__PURE__*/_jsxs(\"div\",{className:\"col border\",children:[/*#__PURE__*/_jsx(\"h1\",{children:company[0].name}),/*#__PURE__*/_jsx(\"h2\",{children:company[0].address}),/*#__PURE__*/_jsx(\"h2\",{children:/*#__PURE__*/_jsx(\"a\",{href:company[0].url,target:\"blank\",children:company[0].url})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:company[1].length>0?company[1].map(function(job){return/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Job Posting\"}),/*#__PURE__*/_jsx(\"h4\",{children:job.position}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"$\",job.hourly_pay,\"/hour\"]}),/*#__PURE__*/_jsx(\"h4\",{children:formatDate(job.date)}),job.applications.length>0?job.applications.map(function(applicant){return/*#__PURE__*/_jsx(Application,{applicant:applicant,job:job,acceptApplicant:acceptApplicant,denyApplicant:denyApplicant,decided:decided},applicant[1]);}):/*#__PURE__*/_jsx(\"h4\",{children:\"No applicants\"}),/*#__PURE__*/_jsx(Button,{className:\"mb-3\",onClick:function onClick(){return deleteJob(job.id);},variant:\"contained\",color:\"primary\",children:\"Remove Posting\"}),/*#__PURE__*/_jsx(\"div\",{children:errors.length?/*#__PURE__*/_jsx(\"p\",{children:errors}):null})]},job.id);}):/*#__PURE__*/_jsx(\"h4\",{children:\"No applications to display\"})})]},company[0].id);})})]}):/*#__PURE__*/_jsx(\"h1\",{children:\"Currently no applications to display\"});};export default CompaniesApplications;","map":{"version":3,"sources":["/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/src/components/companies/CompaniesApplications.js"],"names":["React","useState","useEffect","ChefApi","Button","formatDate","Application","CompaniesApplications","currentUser","companies","setCompanies","decided","setDecided","isLoading","setIsLoading","errors","setErrors","getApplications","applicationsArr","getCompaniesFromUsername","userCompanies","company","getJobsForCompany","id","companyApplications","push","acceptApplicant","username","jobId","e","updateApplication","status","alert","denyApplicant","deleteJob","console","log","length","map","name","address","url","job","position","hourly_pay","date","applications","applicant"],"mappings":"qvBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,OAAP,KAAoB,YAApB,CACA,OAASC,MAAT,KAAuB,mBAAvB,CACA,OAASC,UAAT,KAA2B,sBAA3B,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,C,wFAEA,GAAMC,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,MAAmB,IAAjBC,CAAAA,WAAiB,MAAjBA,WAAiB,CAC7C,cAAkCP,QAAQ,CAAC,IAAD,CAA1C,wCAAOQ,SAAP,eAAkBC,YAAlB,eACA,eAA8BT,QAAQ,CAAC,KAAD,CAAtC,yCAAOU,OAAP,eAAgBC,UAAhB,eACA,eAAkCX,QAAQ,CAAC,IAAD,CAA1C,yCAAOY,SAAP,eAAkBC,YAAlB,eACA,eAA4Bb,QAAQ,CAAC,EAAD,CAApC,yCAAOc,MAAP,eAAeC,SAAf,eAEAd,SAAS,CAAC,UAAM,SACGe,CAAAA,eADH,uJACZ,iNACQC,eADR,CAC0B,EAD1B,uBAEgCf,CAAAA,OAAO,CAACgB,wBAAR,CAAiCX,WAAjC,CAFhC,QAEUY,aAFV,oDAGwBA,aAAa,CAACX,SAHtC,8FAGaY,OAHb,oCAI0ClB,CAAAA,OAAO,CAACmB,iBAAR,CAA0BD,OAAO,CAACE,EAAlC,CAJ1C,SAIcC,mBAJd,eAKQN,eAAe,CAACO,IAAhB,CAAqB,CAACJ,OAAD,CAAUG,mBAAV,CAArB,EALR,0NAOId,YAAY,CAACQ,eAAD,CAAZ,CACAJ,YAAY,CAAC,KAAD,CAAZ,CACAF,UAAU,CAAC,KAAD,CAAV,CATJ,2EADY,kDAYZ,GAAIC,SAAS,EAAIL,WAAW,GAAK,IAAjC,CAAuC,CACnCS,eAAe,GAClB,CACJ,CAfQ,CAeN,CAACN,OAAD,CAAUH,WAAV,CAAuBK,SAAvB,CAfM,CAAT,CAkBA,GAAMa,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,0CAAEC,QAAF,UAAYC,KAAZ,0GAAuB,kBAAOC,CAAP,wJACtB1B,CAAAA,OAAO,CAAC2B,iBAAR,CAA0BH,QAA1B,CAAoCC,KAApC,CAA2C,CAACG,MAAM,CAAE,UAAT,CAA3C,CADsB,QACrCA,MADqC,gBAE3CnB,UAAU,CAAC,IAAD,CAAV,CACAoB,KAAK,oBAAaD,MAAb,cAAL,CAH2C,wDAAvB,iEAAxB,CAMA,GAAME,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,0CAAEN,QAAF,UAAYC,KAAZ,0GAAuB,kBAAOC,CAAP,wJACpB1B,CAAAA,OAAO,CAAC2B,iBAAR,CAA0BH,QAA1B,CAAoCC,KAApC,CAA2C,CAACG,MAAM,CAAE,QAAT,CAA3C,CADoB,QACnCA,MADmC,gBAEzCnB,UAAU,CAAC,IAAD,CAAV,CACAoB,KAAK,oBAAaD,MAAb,cAAL,CAHyC,wDAAvB,kEAAtB,CAMC,GAAMG,CAAAA,SAAS,2FAAG,kBAAOX,EAAP,8JAELpB,CAAAA,OAAO,CAAC+B,SAAR,CAAkBX,EAAlB,CAFK,QAGXS,KAAK,eAAL,CAHW,mFAMXG,OAAO,CAACC,GAAR,eACApB,SAAS,wBAAT,CAPW,sEAAH,kBAATkB,CAAAA,SAAS,8CAAf,CAWD,MACI,CAACrB,SAAD,EAAcJ,SAAS,CAAC4B,MAAV,CAAmB,CAAjC,cACA,aAAK,SAAS,CAAC,gBAAf,wBACI,yCADJ,cAEI,aAFJ,cAGI,YAAK,SAAS,CAAC,qBAAf,UACK5B,SAAS,CAAC6B,GAAV,CAAc,SAAAjB,OAAO,qBAClB,aAAK,SAAS,CAAC,YAAf,wBACI,oBAAKA,OAAO,CAAC,CAAD,CAAP,CAAWkB,IAAhB,EADJ,cAEI,oBAAKlB,OAAO,CAAC,CAAD,CAAP,CAAWmB,OAAhB,EAFJ,cAGI,iCAAI,UAAG,IAAI,CAAEnB,OAAO,CAAC,CAAD,CAAP,CAAWoB,GAApB,CAAyB,MAAM,CAAC,OAAhC,UAAyCpB,OAAO,CAAC,CAAD,CAAP,CAAWoB,GAApD,EAAJ,EAHJ,cAII,aAJJ,cAKI,YAAK,SAAS,CAAC,KAAf,UACCpB,OAAO,CAAC,CAAD,CAAP,CAAWgB,MAAX,CAAoB,CAApB,CACGhB,OAAO,CAAC,CAAD,CAAP,CAAWiB,GAAX,CAAe,SAAAI,GAAG,qBACd,aAAK,SAAS,CAAC,KAAf,wBACQ,mCADR,cAEQ,oBAAKA,GAAG,CAACC,QAAT,EAFR,cAGQ,0BAAMD,GAAG,CAACE,UAAV,WAHR,cAIQ,oBAAKvC,UAAU,CAACqC,GAAG,CAACG,IAAL,CAAf,EAJR,CAKKH,GAAG,CAACI,YAAJ,CAAiBT,MAAjB,CAA0B,CAA1B,CACGK,GAAG,CAACI,YAAJ,CAAiBR,GAAjB,CAAqB,SAAAS,SAAS,qBAC1B,KAAC,WAAD,EAEA,SAAS,CAAEA,SAFX,CAGA,GAAG,CAAEL,GAHL,CAIA,eAAe,CAAEhB,eAJjB,CAKA,aAAa,CAAEO,aALf,CAMA,OAAO,CAAEtB,OANT,EACKoC,SAAS,CAAC,CAAD,CADd,CAD0B,EAA9B,CADH,cAWS,qCAhBd,cAiBI,KAAC,MAAD,EACI,SAAS,CAAC,MADd,CAEI,OAAO,CAAE,yBAAMb,CAAAA,SAAS,CAACQ,GAAG,CAACnB,EAAL,CAAf,EAFb,CAGI,OAAO,CAAC,WAHZ,CAII,KAAK,CAAC,SAJV,4BAjBJ,cAwBI,qBACCR,MAAM,CAACsB,MAAP,cACG,mBAAItB,MAAJ,EADH,CAEC,IAHF,EAxBJ,GAA0B2B,GAAG,CAACnB,EAA9B,CADc,EAAlB,CADH,cAiCK,kDAlCN,EALJ,GAAiCF,OAAO,CAAC,CAAD,CAAP,CAAWE,EAA5C,CADkB,EAArB,CADL,EAHJ,GADA,cAoDA,4DArDJ,CAuDH,CAtGD,CAwGA,cAAehB,CAAAA,qBAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport ChefApi from '../api/api';\nimport { Button } from '@material-ui/core';\nimport { formatDate } from '../utilities/utility'; \nimport Application from './Application';\n\nconst CompaniesApplications = ({currentUser}) => {\n    const [companies, setCompanies] = useState(null);\n    const [decided, setDecided] = useState(false);\n    const [isLoading, setIsLoading] = useState(true);\n    const [errors, setErrors] = useState([]);\n\n    useEffect(() => {\n        async function getApplications() { \n            let applicationsArr = []\n            const userCompanies = await ChefApi.getCompaniesFromUsername(currentUser);\n            for (let company of userCompanies.companies) {\n                const companyApplications = await ChefApi.getJobsForCompany(company.id)\n                applicationsArr.push([company, companyApplications])\n            }\n            setCompanies(applicationsArr);\n            setIsLoading(false);\n            setDecided(false);\n        }\n        if (isLoading && currentUser !== null) {\n            getApplications()\n        }\n    }, [decided, currentUser, isLoading])\n\n\n    const acceptApplicant = ([username, jobId]) => async (e) => {\n        const status = await ChefApi.updateApplication(username, jobId, {status: \"APPROVED\"})\n        setDecided(true)\n        alert(`You have ${status} this job`)\n    }\n\n    const denyApplicant = ([username, jobId]) => async (e) => {\n        const status = await ChefApi.updateApplication(username, jobId, {status: \"DENIED\"})\n        setDecided(true)\n        alert(`You have ${status} this job`)    \n    }\n\n     const deleteJob = async (id) => {\n        try {\n            await ChefApi.deleteJob(id)\n            alert(`Deleted job`)\n        }\n        catch (err) {\n            console.log(err)\n            setErrors(`Unable to delete job`)\n        }\n    }\n\n    return (\n        !isLoading && companies.length > 0 ?\n        <div className=\"container mt-3\">\n            <h1>Open Applications</h1>\n            <br></br>\n            <div className=\"row applications-ul\">\n                {companies.map(company => (\n                    <div className=\"col border\" key={company[0].id}>\n                        <h1>{company[0].name}</h1>\n                        <h2>{company[0].address}</h2>\n                        <h2><a href={company[0].url} target=\"blank\">{company[0].url}</a></h2>\n                        <br></br>\n                        <div className=\"row\">                           \n                        {company[1].length > 0 ?\n                            company[1].map(job => (\n                                <div className=\"col\" key={job.id}>\n                                        <h2>Job Posting</h2>   \n                                        <h4>{job.position}</h4>\n                                        <h4>${job.hourly_pay}/hour</h4>\n                                        <h4>{formatDate(job.date)}</h4>\n                                    {job.applications.length > 0 ?\n                                        job.applications.map(applicant => (\n                                            <Application \n                                            key={applicant[1]}\n                                            applicant={applicant} \n                                            job={job}\n                                            acceptApplicant={acceptApplicant}\n                                            denyApplicant={denyApplicant}\n                                            decided={decided}\n                                            />\n                                            ))\n                                            : <h4>No applicants</h4> }\n                                    <Button \n                                        className=\"mb-3\"\n                                        onClick={() => deleteJob(job.id)}\n                                        variant=\"contained\" \n                                        color=\"primary\">\n                                        Remove Posting\n                                    </Button>\n                                    <div>\n                                    {errors.length ?\n                                        <p>{errors}</p>\n                                    : null }\n                                    </div>\n                                </div>\n                                ))\n                            : <h4>No applications to display</h4>}\n                         </div>\n                    </div>\n                ))}\n            </div>\n        </div>\n        : \n        <h1>Currently no applications to display</h1>\n    )\n}\n\nexport default CompaniesApplications;"]},"metadata":{},"sourceType":"module"}