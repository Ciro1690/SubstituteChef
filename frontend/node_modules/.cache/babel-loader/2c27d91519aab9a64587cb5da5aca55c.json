{"ast":null,"code":"import _defineProperty from\"/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useEffect}from'react';import{editUser}from'../utilities/utility';import UserContext from'../routes/UserContext';import ChefApi from'../api/api';import{useHistory}from'react-router';import{TextField,Button,ButtonGroup}from'@material-ui/core';import Box from'@material-ui/core/Box';import DeleteIcon from'@material-ui/icons/Delete';import SaveIcon from'@material-ui/icons/Save';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UserProfile=function UserProfile(_ref){var setUserInfo=_ref.setUserInfo,LogOut=_ref.LogOut;var _useContext=useContext(UserContext),userInfo=_useContext.userInfo;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),errors=_useState4[0],setErrors=_useState4[1];var history=useHistory();useEffect(function(){if(userInfo!==null){setFormData({firstName:userInfo.firstName,lastName:userInfo.lastName,email:userInfo.email});}},[userInfo]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var editData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();editData={\"firstName\":formData.firstName,\"lastName\":formData.lastName,\"email\":formData.email};_context.next=4;return editUser(userInfo.username,editData).then(function(res){if(res.success){var NEW_STATE={\"firstName\":res.user.firstName,\"lastName\":res.user.lastName,\"email\":res.user.email};setUserInfo(function(data){return _objectSpread(_objectSpread({},data),NEW_STATE);});alert(\"Updated user info\");}else{setErrors(res.errors);}});case 4:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var deleteUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return ChefApi.deleteUser(userInfo.username);case 3:user=_context2.sent;alert(\"Deleted \".concat(user.deleted,\". Sorry to see you go!\"));LogOut();history.push('/');_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);setErrors(\"Unable to delete \".concat(userInfo.username));case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return function deleteUser(){return _ref3.apply(this,arguments);};}();var handleChange=function handleChange(e){var name=e.target.name;var value=e.target.type==='checkbox'?e.target.checked:e.target.value;setFormData(function(data){return _objectSpread(_objectSpread({},data),{},_defineProperty({},name,value));});};return/*#__PURE__*/_jsx(\"div\",{className:\"mt-3\",children:formData===null?/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Edit User Profile\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(TextField,{label:\"First Name\",type:\"text\",name:\"firstName\",onChange:handleChange,value:formData.firstName}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(TextField,{label:\"Last Name\",type:\"text\",name:\"lastName\",onChange:handleChange,value:formData.lastName}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(TextField,{label:\"Email\",type:\"email\",name:\"email\",onChange:handleChange,value:formData.email}),/*#__PURE__*/_jsx(Box,{m:2,p:3,children:/*#__PURE__*/_jsxs(ButtonGroup,{size:\"small\",\"aria-label\":\"small outlined button group\",children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"secondary\",className:\"btn mr-2\",startIcon:/*#__PURE__*/_jsx(SaveIcon,{}),children:\"Edit Account\"}),/*#__PURE__*/_jsx(Button,{onClick:deleteUser,variant:\"contained\",color:\"primary\",startIcon:/*#__PURE__*/_jsx(DeleteIcon,{}),children:\"Delete Account\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{children:errors.length?/*#__PURE__*/_jsx(\"p\",{children:errors}):null})]})});};export default UserProfile;","map":{"version":3,"sources":["/Users/cheers/Desktop/Coding/Springboard/substitute-chef/frontend/src/components/user/UserProfile.js"],"names":["React","useState","useContext","useEffect","editUser","UserContext","ChefApi","useHistory","TextField","Button","ButtonGroup","Box","DeleteIcon","SaveIcon","UserProfile","setUserInfo","LogOut","userInfo","formData","setFormData","errors","setErrors","history","firstName","lastName","email","handleSubmit","e","preventDefault","editData","username","then","res","success","NEW_STATE","user","data","alert","deleteUser","deleted","push","console","log","handleChange","name","target","value","type","checked","length"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\nimport { editUser } from '../utilities/utility';\nimport UserContext from '../routes/UserContext';\nimport ChefApi from '../api/api';\nimport { useHistory } from 'react-router';\nimport {\n    TextField,\n    Button,\n    ButtonGroup } from '@material-ui/core';\nimport Box from '@material-ui/core/Box';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport SaveIcon from '@material-ui/icons/Save';\nconst UserProfile = ({ setUserInfo, LogOut }) => {\n\n    const { userInfo } = useContext(UserContext);\n    const [formData, setFormData] = useState(null);\n    const [errors, setErrors] = useState([]);\n    let history = useHistory();\n    \n    useEffect(() => {\n        if (userInfo !== null) {\n            setFormData({\n                firstName: userInfo.firstName,\n                lastName: userInfo.lastName,\n                email: userInfo.email\n            });\n        }\n    }, [userInfo])\n    \n    const handleSubmit = async e => {\n    e.preventDefault();\n    const editData = {\n        \"firstName\": formData.firstName,\n        \"lastName\": formData.lastName,\n        \"email\": formData.email\n    };\n    await editUser(userInfo.username, editData)\n        .then((res) => {\n            if (res.success) {\n                const NEW_STATE = {\n                    \"firstName\": res.user.firstName,\n                    \"lastName\": res.user.lastName,\n                    \"email\": res.user.email\n                }\n                setUserInfo(data => ({\n                    ...data,\n                    ...NEW_STATE\n                }))\n                alert(\"Updated user info\")\n            }\n            else {\n                setErrors(res.errors);\n            }\n        })\n    }\n\n    const deleteUser = async () => {\n        try {\n            const user = await ChefApi.deleteUser(userInfo.username)\n            alert(`Deleted ${user.deleted}. Sorry to see you go!`)\n            LogOut()\n            history.push('/')\n        }\n        catch (err) {\n            console.log(err)\n            setErrors(`Unable to delete ${userInfo.username}`)\n        }\n    }\n\n    const handleChange = e => {\n        const name = e.target.name;\n        const value = e.target.type === 'checkbox' ? e.target.checked : e.target.value;\n        setFormData(data => ({\n            ...data,\n            [name]: value\n        }))\n    }\n\n    return (\n        <div className=\"mt-3\">\n        {formData === null  ? <p>Loading...</p> :\n            <div>\n                <h1>Edit User Profile</h1>\n                <form onSubmit={handleSubmit}>\n                    <TextField\n                        label=\"First Name\"\n                        type=\"text\"\n                        name=\"firstName\"\n                        onChange={handleChange}\n                        value={formData.firstName}/>\n                        <br></br>\n                    <TextField\n                        label=\"Last Name\"\n                        type=\"text\"\n                        name=\"lastName\"\n                        onChange={handleChange}\n                        value={formData.lastName}/>\n                        <br></br>\n                    <TextField\n                        label=\"Email\"\n                        type=\"email\"\n                        name=\"email\"\n                        onChange={handleChange}\n                        value={formData.email}/>\n                    <Box m={2} p={3}>\n                        <ButtonGroup size=\"small\" aria-label=\"small outlined button group\">\n                            <Button \n                                type=\"submit\"\n                                variant=\"contained\" \n                                color=\"secondary\"\n                                className=\"btn mr-2\"\n                                startIcon={<SaveIcon />}>\n                                Edit Account\n                            </Button>                    \n                            <Button \n                                onClick={deleteUser}\n                                variant=\"contained\" \n                                color=\"primary\"\n                                startIcon={<DeleteIcon />}>\n                                Delete Account\n                            </Button>\n                        </ButtonGroup>\n                    </Box>\n                </form>\n                <div>\n                    {errors.length ?\n                        <p>{errors}</p>\n                        : null }\n                </div>\n            </div>\n        }\n        </div>\n    )\n}\n\nexport default UserProfile;"]},"metadata":{},"sourceType":"module"}